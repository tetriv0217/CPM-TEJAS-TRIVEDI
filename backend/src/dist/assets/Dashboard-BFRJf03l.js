import{a as y,h as P,ah as e,ap as J,aq as X,ai as M,ao as _}from"./index-Ceshqiaz.js";import{I as U,a4 as N,ac as Y,ad as Z,ae as ee,aa as O,a1 as m,af as D,a2 as f,y as te,ag as L}from"./IdurarOs-QiO0mqNX.js";import{u as q}from"./useDate-DhPwrpth.js";import{u as R}from"./useFetch-zry2Bn3b.js";import{t as ae}from"./statusTagColor-DxbKI3gy.js";import{e as k}from"./actions-CqH49u7k.js";import{F as ne}from"./FilePdfOutlined-BaKFpz2K.js";import{D as se,E as re,s as V}from"./ErpApp-HOQT9QP8.js";import{F as oe}from"./Table-BaNNn-lR.js";import{T as Q}from"./index-Y7wTz0MG.js";import{P as W}from"./progress-CxBazKQE.js";import{S as ie}from"./index-CIN5epRq.js";var le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},ce=function(a,s){return y.createElement(U,P({},a,{ref:s,icon:le}))};const de=y.forwardRef(ce);var ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},pe=function(a,s){return y.createElement(U,P({},a,{ref:s,icon:ue}))};const ge=y.forwardRef(pe);function E({...t}){const a=N();let{entity:s,dataTableColumns:r}=t;const o=[{label:a("Show"),key:"read",icon:e.jsx(Y,{})},{label:a("Edit"),key:"edit",icon:e.jsx(Z,{})},{label:a("Download"),key:"download",icon:e.jsx(ne,{})}],d=J(),n=X(),l=c=>{n(k.currentItem({data:c})),d(`/${s}/read/${c._id}`)},u=c=>{n(k.currentAction({actionType:"update",data:c})),d(`/${s}/update/${c._id}`)},j=c=>{window.open(`${ee}${s}/${s}-${c._id}.pdf`,"_blank")};r=[...r,{title:"",key:"action",render:(c,p)=>e.jsx(se,{menu:{items:o,onClick:({key:v})=>{switch(v){case"read":l(p);break;case"edit":u(p);break;case"download":j(p);break}}},trigger:["click"],children:e.jsx(re,{style:{cursor:"pointer",fontSize:"24px"},onClick:v=>v.preventDefault()})})}];const g=()=>O.list({entity:s}),{result:w,isLoading:C,isSuccess:A}=R(g),F=()=>A&&w?w.slice(0,5):[];return e.jsx(oe,{columns:r,rowKey:c=>c._id,dataSource:A&&F(),pagination:!1,loading:C,scroll:{x:!0}})}function S({title:t,tagColor:a,data:s,prefix:r,isLoading:o=!1}){const{moneyFormatter:d}=q(),n=M(V);return e.jsx(m,{className:"gutter-row",xs:{span:24},sm:{span:12},md:{span:12},lg:{span:6},children:e.jsxs("div",{className:"whiteBox shadow",style:{color:"#595959",fontSize:13,minHeight:"106px",height:"100%"},children:[e.jsx("div",{className:"pad15 strong",style:{textAlign:"center",justifyContent:"center"},children:e.jsx("h3",{style:{color:"#22075e",fontSize:"large",margin:"5px 0",textTransform:"capitalize"},children:t})}),e.jsx(D,{style:{padding:0,margin:0}}),e.jsx("div",{className:"pad15",children:e.jsxs(f,{gutter:[0,0],justify:"space-between",wrap:!1,children:[e.jsx(m,{className:"gutter-row",flex:"85px",style:{textAlign:"left"},children:e.jsx("div",{className:"left",style:{whiteSpace:"nowrap"},children:r})}),e.jsx(D,{style:{height:"100%",padding:"10px 0",justifyContent:"center",alignItems:"center"},type:"vertical"}),e.jsx(m,{className:"gutter-row",flex:"auto",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:o?e.jsx(_,{}):e.jsx(te,{title:s,style:{direction:"ltr"},children:e.jsx(Q,{color:a,style:{margin:"0 auto",justifyContent:"center",maxWidth:"110px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",direction:"ltr"},children:d(s?{amount:s,currency_code:n==null?void 0:n.default_currency_code}:{amount:0,currency_code:n==null?void 0:n.default_currency_code})})})})]})})]})})}const $={draft:"#595959",sent:"#1890ff",pending:"#1890ff",unpaid:"#ffa940",overdue:"#ff4d4f",partially:"#13c2c2",paid:"#95de64",declined:"#ff4d4f",accepted:"#95de64",cyan:"#13c2c2",purple:"#722ed1",expired:"#614700"},z=[{tag:"draft",value:0},{tag:"pending",value:0},{tag:"sent",value:0},{tag:"accepted",value:0},{tag:"declined",value:0},{tag:"expired",value:0}],he=[{tag:"draft",value:0},{tag:"pending",value:0},{tag:"overdue",value:0},{tag:"paid",value:0},{tag:"unpaid",value:0},{tag:"partially",value:0}],me=({tag:t,color:a,value:s})=>{const r=N();return e.jsxs("div",{style:{color:"#595959",marginBottom:5},children:[e.jsx("div",{className:"left alignLeft capitalize",children:r(t)}),e.jsxs("div",{className:"right alignRight",children:[s," %"]}),e.jsx(W,{percent:s,showInfo:!1,strokeColor:{"0%":a,"100%":a}})]})};function xe({title:t="Preview",statistics:a=z,isLoading:s=!1,entity:r="invoice"}){const o=y.useMemo(()=>r==="invoice"?he.map(n=>(Array.isArray(a)?a.find(u=>u.tag===n.tag):null)||n):z.map(n=>(Array.isArray(a)?a.find(u=>u.tag===n.tag):null)||n),[a,r]),d=(n,l)=>{const u=Object.values($),j=u.indexOf(n.props.color),g=u.indexOf(l.props.color);return j-g};return e.jsx(m,{className:"gutter-row",xs:{span:24},sm:{span:24},md:{span:8},lg:{span:8},children:e.jsxs("div",{className:"pad20",children:[e.jsx("h3",{style:{color:"#22075e",fontSize:"large",marginBottom:40,marginTop:0},children:t}),s?e.jsx("div",{style:{textAlign:"center"},children:e.jsx(_,{})}):o==null?void 0:o.map((n,l)=>e.jsx(me,{tag:n.tag,color:$[n.tag],value:n==null?void 0:n.value},l)).sort(d)]})})}function fe({isLoading:t=!1,activeCustomer:a=0,newCustomer:s=0}){const r=N();return e.jsx(f,{className:"gutter-row",children:e.jsx("div",{className:"whiteBox shadow",style:{height:458},children:e.jsxs("div",{className:"pad20",style:{textAlign:"center",justifyContent:"center"},children:[e.jsx("h3",{style:{color:"#22075e",marginBottom:40,marginTop:15,fontSize:"large"},children:r("Customers")}),t?e.jsx(_,{}):e.jsxs("div",{style:{display:"grid",justifyContent:"center"},children:[e.jsx(W,{type:"dashboard",percent:s,size:148}),e.jsx("p",{children:r("New Customer this Month")}),e.jsx(D,{}),e.jsx(ie,{title:r("Active Customer"),value:a,precision:2,valueStyle:a>0?{color:"#3f8600"}:a<0?{color:"#cf1322"}:{color:"#000000"},prefix:a>0?e.jsx(ge,{}):a<0?e.jsx(de,{}):null,suffix:"%"})]})]})})})}function ye(){const t=N(),{moneyFormatter:a}=q(),s=M(V),r=async({entity:i,currency:h})=>await O.summary({entity:i,options:{currency:h}}),{result:o,isLoading:d,onFetch:n}=L(),{result:l,isLoading:u,onFetch:j}=L(),{result:g,isLoading:w,onFetch:C}=L(),{result:A,isLoading:F,onFetch:c}=L(),{result:p,isLoading:v}=R(()=>O.summary({entity:"client"}));y.useEffect(()=>{const i=s.default_currency_code||null;i&&(n(r({entity:"invoice",currency:i})),j(r({entity:"quote",currency:i})),C(r({entity:"offer",currency:i})),c(r({entity:"payment",currency:i})))},[s.default_currency_code]);const I=[{title:t("number"),dataIndex:"number"},{title:t("Client"),dataIndex:["client","name"]},{title:t("Total"),dataIndex:"total",onCell:()=>({style:{textAlign:"right",whiteSpace:"nowrap",direction:"ltr"}}),render:(i,h)=>a({amount:i,currency_code:h.currency})},{title:t("Status"),dataIndex:"status",render:i=>{var h;return e.jsx(Q,{color:(h=ae(i))==null?void 0:h.color,children:t(i)})}}],H=[{result:o,isLoading:d,entity:"invoice",title:t("Invoices")},{result:l,isLoading:u,entity:"quote",title:t("proforma invoices")},{result:g,isLoading:w,entity:"offer",title:t("offers")}].map((i,h)=>{var B;const{result:b,entity:K,isLoading:T,title:G}=i;return e.jsx(xe,{title:G,isLoading:T,entity:K,statistics:!T&&((B=b==null?void 0:b.performance)==null?void 0:B.map(x=>({tag:x==null?void 0:x.status,color:"blue",value:x==null?void 0:x.percentage})))},h)});return s?e.jsxs(e.Fragment,{children:[e.jsxs(f,{gutter:[32,32],children:[e.jsx(S,{title:t("Invoices"),tagColor:"cyan",prefix:t("This month"),isLoading:d,data:o==null?void 0:o.total}),e.jsx(S,{title:t("proforma invoices"),tagColor:"purple",prefix:t("This month"),isLoading:u,data:l==null?void 0:l.total}),e.jsx(S,{title:t("offers"),tagColor:"green",prefix:t("This month"),isLoading:w,data:g==null?void 0:g.total}),e.jsx(S,{title:t("Unpaid"),tagColor:"red",prefix:t("Not Paid"),isLoading:d,data:o==null?void 0:o.total_undue})]}),e.jsx("div",{className:"space30"}),e.jsxs(f,{gutter:[32,32],children:[e.jsx(m,{className:"gutter-row w-full",sm:{span:24},md:{span:24},lg:{span:18},children:e.jsx("div",{className:"whiteBox shadow",style:{height:458},children:e.jsx(f,{className:"pad20",gutter:[0,0],children:H})})}),e.jsx(m,{className:"gutter-row w-full",sm:{span:24},md:{span:24},lg:{span:6},children:e.jsx(fe,{isLoading:v,activeCustomer:p==null?void 0:p.active,newCustomer:p==null?void 0:p.new})})]}),e.jsx("div",{className:"space30"}),e.jsxs(f,{gutter:[32,32],children:[e.jsx(m,{className:"gutter-row w-full",sm:{span:24},lg:{span:12},children:e.jsxs("div",{className:"whiteBox shadow pad20",style:{height:"100%"},children:[e.jsx("h3",{style:{color:"#22075e",marginBottom:5,padding:"0 20px 20px"},children:t("Recent Invoices")}),e.jsx(E,{entity:"invoice",dataTableColumns:I})]})}),e.jsx(m,{className:"gutter-row w-full",sm:{span:24},lg:{span:12},children:e.jsxs("div",{className:"whiteBox shadow pad20",style:{height:"100%"},children:[e.jsx("h3",{style:{color:"#22075e",marginBottom:5,padding:"0 20px 20px"},children:t("Recent Quotes")}),e.jsx(E,{entity:"quote",dataTableColumns:I})]})})]})]}):e.jsx(e.Fragment,{})}function Ie(){return e.jsx(ye,{})}export{Ie as default};
