import{aq as $,ap as A,a as c,ai as C,ah as t}from"./index-Ceshqiaz.js";import{P as E}from"./index-BauFKgOT.js";import{a4 as L,ai as S,a6 as I,V as w,af as B,ak as N}from"./IdurarOs-QiO0mqNX.js";import{e as R}from"./ErpApp-HOQT9QP8.js";import{e as T}from"./actions-CqH49u7k.js";import{g as H}from"./selectors-DzM9jS4k.js";import{c as r}from"./calculate-Dn_E62tH.js";import{s as b}from"./index-KrFx5yLV.js";import{T as _}from"./index-Y7wTz0MG.js";import{C as z}from"./CloseCircleOutlined-C9A4eADL.js";import{A as G,a as J}from"./ArrowRightOutlined-zWlOlZvh.js";import{P as K}from"./PlusOutlined-DgQpfvsa.js";function M({form:l}){const u=L(),o=()=>{l.submit()};return t.jsx(w,{onClick:o,type:"primary",icon:t.jsx(K,{}),children:u("Save")})}function rt({config:l,CreateForm:u}){const o=L(),f=$(),m=A();c.useEffect(()=>{f(R.list({entity:"setting"}))},[]);let{entity:i}=l;const{isLoading:k,isSuccess:h,result:q}=C(H),[p]=S.useForm(),[v,j]=c.useState(0),[D,y]=c.useState(0),F=(a,n)=>{const s=n.items;let d=0,g=0;s&&(s.map(e=>{if(e){if(e.offerPrice&&e.quantity){let x=r.multiply(e.quantity,e.offerPrice);g=r.add(g,x)}if(e.quantity&&e.price){let x=r.multiply(e.quantity,e.price);d=r.add(d,x)}}}),j(d),y(g))};c.useEffect(()=>(h&&(p.resetFields(),f(T.resetAction({actionType:"create"})),j(0),y(0),m(`/${i.toLowerCase()}/read/${q._id}`)),()=>{}),[h]);const O=a=>{if(console.log("ðŸš€ ~ onSubmit ~ fieldsValue:",a),a&&a.items){let n=[...a.items];n.map(s=>{s.total=r.multiply(s.quantity,s.price)}),a={...a,items:n}}f(T.create({entity:i,jsonData:a}))},P=C(I);return t.jsxs(t.Fragment,{children:[t.jsx(E,{onBack:()=>{m(`/${i.toLowerCase()}`)},backIcon:P==="rtl"?t.jsx(G,{}):t.jsx(J,{}),title:o("New"),ghost:!1,tags:t.jsx(_,{children:o("Draft")}),extra:[t.jsx(w,{onClick:()=>m(`/${i.toLowerCase()}`),icon:t.jsx(z,{}),children:o("Cancel")},`${b.generate()}`),t.jsx(M,{form:p},`${b.generate()}`)],style:{padding:"20px 0px"}}),t.jsx(B,{dashed:!0}),t.jsx(N,{isLoading:k,children:t.jsx(S,{form:p,layout:"vertical",onFinish:O,onValuesChange:F,children:t.jsx(u,{subTotal:v,offerTotal:D})})})]})}export{rt as C};
